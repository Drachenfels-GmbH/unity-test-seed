About
===========

Integrate the C testing harness [Unity](http://throwtheswitch.org/white-papers/unity-intro.html) in the wink of an eye.

Getting started
-----------------

Clone the repository and run:

```bash
# download and extract unity source
# -> creates unity/*
make bootstrap

# generate two test files/groups
# -> creates: test_foo.c,test_bar.c
make new name=foo
make new name=bar

# run all test files/groups
# -> creates: .run_tests.c, .run_tests
make

# run only test group `foo`
make TESTS=foo
```

Expected output:
```
...
Unity test run 1 of 1
.test_bar.c:9:TEST(bar, TestCase1):FAIL: Expected TRUE Was FALSE
.test_foo.c:9:TEST(foo, TestCase1):FAIL: Expected TRUE Was FALSE

-----------------------
2 Tests 2 Failures 0 Ignored
FAIL
make: *** [default] Error 2
```

### Customize

Usually you do not have to modify the `Makefile` itself.
You can instead overwrite the following environment variables to affect
the test compilation:

* `CFLAGS` : set custom CFLAGS (include libraries, headers, set preprocessor macros ...)
* `SRC` : to include additional source files
* `EDITOR` : to set your default editor to open a test file/group automatically after `make new name=<name>`

I usually create a file (`env.sh`) that exports all required variables
and `source` that file before running the tests / after modification.

```bash
# only exported variables are available in Makefile
export EDITOR=vim
export CFLAGS="-DTRACE -Wno-long-long -I/usr/local/include -L/usr/local/lib  -lssl -lcrypto"
export SRC="../src/verify.c"
```

### Templates

* The template for `make new` is [bin/group.c.template](bin/group.c.template)
* The template for the test runner is generated by  [bin/assemble_groups.sh](bin/assemble_groups.sh)
